{{ config(
    materialized='table'
) }}

select
    match_status_id match_stats_id, -- i think this is a typo in the API response
    event_id,
    competition_code,
    category_code,
    age_category_code,
    para_class,
    message_source,
    message_type,
    match_id,
    sub_event_code,
    header_version,
    header_result_status,
    header_feed_flag,
    header_logical_date,
    header_logical_time,
    header_utc_date,
    header_utc_time,
    header_local_date,
    header_local_time,
    table_no,
    start_date_local,
    start_date_utc,
    duration,
    sub_event_name,
    match_description,
    gender,
    best_of_x_games,
    match_number,
    phase_name,
    venue,
    venue_name,
    max_points_per_game,
    advantage_per_game,
    sudden_death_point,
    ttr_review,
    max_challenges_per_competitor,
    yellow_card,
    yellow_red1,
    yellow_red2,
    competitor1_id,
    competitor1_type,
    competitor1_wlt,
    competitor1_org_name,
    competitor1_pts_won_value,
    competitor1_lead_max_value,
    competitor1_lead_max_agnst_value,
    competitor1_pts_service_won_value,
    competitor1_pts_opp_service_won_value,
    competitor1_pts_service_lost_value,
    competitor1_pts_opp_service_lost_value,
    competitor1_pts_consec_value,
    competitor1_def_ovc_max_value,
    competitor2_id,
    competitor2_type,
    competitor2_wlt,
    competitor2_org_name,
    competitor2_pts_won_value,
    competitor2_lead_max_value,
    competitor2_lead_max_agnst_value,
    competitor2_pts_service_won_value,
    competitor2_pts_opp_service_won_value,
    competitor2_pts_service_lost_value,
    competitor2_pts_opp_service_lost_value,
    competitor2_pts_consec_value,
    competitor2_def_ovc_max_value,
    athelete1_id,
    athelete1_given_name,
    athelete1_family_name,
    athelete1_gender,
    athelete1_organization,
    athelete1_birth_date,
    athelete1_if_id,
    try_cast(nullif(athelete1_seed, '') as int) athelete1_seed,
    athelete2_id,
    athelete2_given_name,
    athelete2_family_name,
    athelete2_gender,
    athelete2_organization,
    athelete2_birth_date,
    athelete2_if_id,
    try_cast(nullif(athelete2_seed, '') as int) athelete2_seed,
    home,
    away,
    irm1,
    irm2,
    wlt1,
    wlt2,
    competitor_result1,
    competitor_result2,
    match_score,
    game_score,
    competitor1_g1_score,
    competitor2_g1_score,
    competitor1_g2_score,
    competitor2_g2_score,
    competitor1_g3_score,
    competitor2_g3_score,
    competitor1_g4_score,
    competitor2_g4_score,
    competitor1_g5_score,
    competitor2_g5_score,
    created_date_time_utc,
    offline_scoring,
    offline_scoring_reason,
    _dlt_load_id,
    _dlt_id,
    competitor1_team_name,
    competitor2_team_name,
    athelete1d_id,
    athelete1d_given_name,
    athelete1d_family_name,
    athelete1d_gender,
    athelete1d_organization,
    athelete1d_birth_date,
    athelete1d_if_id,
    athelete1d_seed,
    athelete2d_id,
    athelete2d_given_name,
    athelete2d_family_name,
    athelete2d_gender,
    athelete2d_organization,
    athelete2d_birth_date,
    athelete2d_if_id,
    athelete2d_seed,
    competitor1_g6_score,
    competitor2_g6_score,
    competitor1_g7_score,
    competitor2_g7_score
from {{ source('wtt_dlt_data', 'match_stats') }}
